(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     26152,        689]
NotebookOptionsPosition[     25010,        661]
NotebookOutlinePosition[     25427,        678]
CellTagsIndexPosition[     25384,        675]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Load", " ", "the", " ", "packages"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"<<", "PhysicalConstants`"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"<<", "Units`"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.93420170698866*^9, 3.934201711767051*^9}, 
   3.934201811049497*^9, {3.934201850889509*^9, 3.934201859764773*^9}, {
   3.934202121468891*^9, 3.93420213127321*^9}, {3.934202315684619*^9, 
   3.9342023160276537`*^9}, {3.934202428733904*^9, 3.934202429216961*^9}, {
   3.934202620134716*^9, 3.934202657438938*^9}, {3.93420277820369*^9, 
   3.934202778542*^9}, 3.934203930304341*^9, 3.934205226474777*^9, {
   3.934254000079446*^9, 3.934254001002063*^9}, {3.934842552656086*^9, 
   3.934842553478562*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"fed76a7f-45c0-4e6e-b223-ec764040dce8"],

Cell[BoxData[
 TemplateBox[{
  "General", "obspkg", 
   "\"\\!\\(\\*RowBox[{\\\"\\\\\\\"PhysicalConstants`\\\\\\\"\\\"}]\\) is now \
obsolete. The legacy version being loaded may conflict with current \
functionality. See the Compatibility Guide for updating information.\"", 2, 1,
    1, 17566950849663965157, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.934201812619885*^9, 3.934201870809846*^9, {3.934202126437481*^9, 
   3.934202137602553*^9}, 3.934202316898802*^9, {3.934202634842464*^9, 
   3.934202658054964*^9}, 3.9342027793377132`*^9, 3.934203454522249*^9, 
   3.934203810964835*^9, 3.934203930742782*^9, 3.934205003656282*^9, 
   3.934205226944322*^9, 3.934205582790831*^9, 3.9342066884261208`*^9, 
   3.934245472945234*^9, 3.934253766106591*^9, 3.934254001330297*^9, 
   3.93425675059516*^9, 3.934259088868703*^9, 3.934259720928501*^9, 
   3.934260817999281*^9, 3.934261487197679*^9, 3.93426453415609*^9, 
   3.93426640852384*^9, 3.934270863621695*^9, 3.934271719287657*^9, 
   3.934273474133223*^9, 3.934274440860227*^9, 3.934274494058898*^9, 
   3.93427463303746*^9, 3.934278476651322*^9, 3.934289564192912*^9, 
   3.934291884438196*^9, 3.934292993095752*^9, 3.934293223607445*^9, 
   3.93432167429253*^9, 3.9343254780991583`*^9, 3.934328497129999*^9, 
   3.934347384869228*^9, 3.93434846629532*^9, 3.934349519442804*^9, 
   3.934349759405714*^9, 3.934351848806563*^9, 3.93435370403504*^9, {
   3.934354286763783*^9, 3.934354310015699*^9}, 3.9343573351090317`*^9, 
   3.9343634897179003`*^9, 3.934374511909354*^9, 3.934376408180278*^9, 
   3.934376550566193*^9, 3.934376727556342*^9, 3.934377660690946*^9, 
   3.934377740219624*^9, 3.934409070774433*^9, 3.93441106216494*^9, 
   3.934411442269928*^9, 3.934412089209107*^9, 3.934414050137047*^9, 
   3.934415467237443*^9, 3.934415927544251*^9, 3.934416185278534*^9, 
   3.934418513682893*^9, 3.934423397228436*^9, 3.934446514469556*^9, 
   3.934713930315851*^9, 3.934768118995173*^9, 3.934768933050698*^9, 
   3.934769011065343*^9, 3.934772345625011*^9, 3.934775974326847*^9, 
   3.934781358995817*^9, 3.934782252133569*^9, 3.934784526006058*^9, 
   3.934793791842402*^9, 3.934795416623271*^9, 3.93484065140699*^9, 
   3.934842496033437*^9, 3.934842554420265*^9, 3.934850482131432*^9, 
   3.934853115165118*^9, 3.9348731828472223`*^9, 3.934900190052013*^9, 
   3.934928163428556*^9, 3.9349330861040277`*^9, 3.934937149250183*^9, 
   3.934939897457279*^9, 3.934944968011376*^9, 3.934947941685313*^9, 
   3.934955659489535*^9, 3.934963175405068*^9, 3.935022934825693*^9, 
   3.935028229217281*^9, 3.935114098017438*^9, 3.935126444562778*^9, 
   3.935127899146453*^9, 3.935544842368546*^9},
 CellLabel->
  "\:8a08\:7b97\:4e2d\:ff1aIn[1]:=",ExpressionUUID->"4b6ec72f-82d1-406f-9127-\
c670bccc4d34"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Define", " ", "physical", " ", "constants"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"alpha", "=", "FineStructureConstant"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c", "=", 
     RowBox[{"SpeedOfLight", "//", "First"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"eAu", "=", 
     RowBox[{"ElectronCharge", "//", "First"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fPi", "=", 
     RowBox[{"QuantityMagnitude", "[", 
      RowBox[{"UnitConvert", "[", 
       RowBox[{
        RowBox[{"Quantity", "[", 
         RowBox[{"93", ",", " ", "\"\<MeV\>\""}], "]"}], ",", " ", 
        "\"\<eV\>\""}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gE", "=", "ElectronGFactor"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gP", "=", 
     RowBox[{"ParticleData", "[", 
      RowBox[{"\"\<Proton\>\"", ",", " ", "\"\<GFactor\>\""}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h", "=", 
     RowBox[{"PlanckConstant", "//", "First"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hbar", "=", 
     RowBox[{"QuantityMagnitude", "[", 
      RowBox[{
       RowBox[{"Quantity", "[", 
        RowBox[{"1", ",", "\"\<ReducedPlanckConstant\>\""}], "]"}], ",", 
       "\"\<J*s\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MSolar", "=", 
     RowBox[{"QuantityMagnitude", "[", 
      RowBox[{
       RowBox[{"Quantity", "[", 
        RowBox[{"1", ",", " ", "\"\<SolarMass\>\""}], "]"}], ",", " ", 
       "\"\<Kilograms\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mPl", "=", 
     RowBox[{"PlanckMass", "//", "First"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"mPi", "=", 
     RowBox[{"QuantityMagnitude", "[", 
      RowBox[{"UnitConvert", "[", 
       RowBox[{
        RowBox[{"ParticleData", "[", 
         RowBox[{"\"\<PiZero\>\"", ",", "\"\<Mass\>\""}], "]"}], ",", " ", 
        "\"\<eV/c^2\>\""}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"muB", "=", 
     RowBox[{"QuantityMagnitude", "[", 
      RowBox[{
       RowBox[{"Quantity", "[", 
        RowBox[{"1", ",", "\"\<BohrMagneton\>\""}], "]"}], ",", 
       "\"\<J/T\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rE", "=", 
     RowBox[{"BohrRadius", "//", "First"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.934201846094091*^9, 3.934201943852194*^9}, {
   3.934202056018471*^9, 3.9342020678680477`*^9}, {3.934202098307592*^9, 
   3.934202106350273*^9}, {3.934202145683745*^9, 3.934202153200022*^9}, {
   3.934202287183303*^9, 3.934202312101861*^9}, {3.934202373905077*^9, 
   3.934202379014307*^9}, {3.934202450041109*^9, 3.934202468387163*^9}, {
   3.934202538696707*^9, 3.934202546060663*^9}, {3.934202578654766*^9, 
   3.934202584518481*^9}, {3.934202708612352*^9, 3.934202709879856*^9}, 
   3.934202786201387*^9, {3.93420285823938*^9, 3.934202859583025*^9}, {
   3.934202905925456*^9, 3.934202935633882*^9}, {3.934202990141597*^9, 
   3.934203025763624*^9}, {3.934203065498835*^9, 3.934203082225772*^9}, {
   3.93420312201073*^9, 3.934203128290311*^9}, {3.934203175673031*^9, 
   3.9342031920771427`*^9}, {3.934203300974927*^9, 3.934203394874021*^9}, {
   3.93420343005497*^9, 3.934203451421301*^9}, {3.934203522016759*^9, 
   3.934203534592684*^9}, {3.934203583568549*^9, 3.934203606028206*^9}, {
   3.934203640143504*^9, 3.934203701533885*^9}, {3.934203745795227*^9, 
   3.934203797798533*^9}, {3.93420393302213*^9, 3.934203983908573*^9}, {
   3.934204096409238*^9, 3.93420410053974*^9}, {3.934204255322021*^9, 
   3.934204278209607*^9}, {3.934204374108041*^9, 3.93420437423497*^9}, {
   3.934204538423145*^9, 3.934204559855208*^9}, {3.934205039250425*^9, 
   3.934205040423182*^9}, {3.934205289299278*^9, 3.934205317104046*^9}, {
   3.93420553814097*^9, 3.934205561675037*^9}, {3.934205679374305*^9, 
   3.93420572119997*^9}, {3.934205915221626*^9, 3.934205974577287*^9}, {
   3.934206079040725*^9, 3.934206101668439*^9}, {3.9342061889428*^9, 
   3.9342062176465883`*^9}, {3.934206260047801*^9, 3.934206280409737*^9}, {
   3.934206324484634*^9, 3.934206365777603*^9}, {3.934206416371522*^9, 
   3.934206603659441*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"1b0b008a-0a48-400e-b450-156719303b6a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Conversion", " ", "factors"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CToEv", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"4", "*", "Pi", "*", "alpha"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"1", "/", "2"}], ")"}]}], "/", "eAu"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"kgToEv", "=", 
     RowBox[{
      RowBox[{"c", "^", "2"}], "/", "eAu"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mToEvMinus1", "=", 
     RowBox[{
      RowBox[{"eAu", "/", "h"}], "/", "c"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"JToEv", "=", 
     RowBox[{"1", "/", "eAu"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pcToM", "=", 
     RowBox[{"QuantityMagnitude", "[", 
      RowBox[{
       RowBox[{"Quantity", "[", 
        RowBox[{"1", ",", " ", "\"\<Parsecs\>\""}], "]"}], ",", " ", 
       "\"\<Meters\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sToEvMinus1", "=", 
     RowBox[{"eAu", "/", 
      RowBox[{"(", "hbar", ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TToEv2", "=", 
     RowBox[{
      RowBox[{"kgToEv", "/", "CToEv"}], "/", "sToEvMinus1"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.934203995635181*^9, 3.934204246688579*^9}, {
  3.93420428240434*^9, 3.934204350467265*^9}, {3.93420439296436*^9, 
  3.934204438648843*^9}, {3.934204477221612*^9, 3.934204495915489*^9}, {
  3.934204572987108*^9, 3.934204577410052*^9}, {3.934205043650933*^9, 
  3.93420504528997*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"55491fca-3546-4eb2-b44c-98b0beddd20e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Common", " ", "parameters"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BbarValue", "=", 
     RowBox[{"10", "^", 
      RowBox[{"-", "10"}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"Background", " ", "magnetic", " ", "field", " ", 
     RowBox[{"(", "T", ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"magZ", "=", 
     RowBox[{"2.03", "*", 
      RowBox[{"10", "^", "26"}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "Calculate", " ", "distance", " ", "of", " ", "L1544", " ", "from", " ", 
     "Galactic", " ", "Centre", " ", 
     RowBox[{"(", 
      RowBox[{"eV", "^", 
       RowBox[{"-", "1"}]}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Parameters", " ", "of", " ", "flat", " ", "potential"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f", "=", 
     RowBox[{"1", "*", 
      RowBox[{"10", "^", "26"}]}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"Energy", " ", "scale", " ", "of", " ", "axion", " ", 
     RowBox[{"(", "eV", ")"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"mA", "=", 
     RowBox[{"1", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "22"}]}]}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Axion", " ", "mass"}], ",", " ", 
     RowBox[{
      RowBox[{"1", "e"}], "-", 
      RowBox[{"18", " ", "to", " ", "1", "e"}], "-", 
      RowBox[{"22", " ", 
       RowBox[{"(", "eV", ")"}]}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"mD", "=", 
     RowBox[{"1", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "22"}]}]}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Dark", " ", "photon", " ", "mass"}], ",", " ", 
     RowBox[{
      RowBox[{"1", "e"}], "-", 
      RowBox[{"18", " ", "to", " ", "1", "e"}], "-", 
      RowBox[{"22", " ", 
       RowBox[{"(", "eV", ")"}]}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"mU", "=", 
     RowBox[{"1", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "6"}]}], "*", "mD"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "Chemical", " ", "potential", " ", "of", " ", "dark", " ", "photon", " ", 
     
     RowBox[{"(", "eV", ")"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"rcPc", "=", "180"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"Core", " ", "radius", " ", 
     RowBox[{"(", "pc", ")"}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Calculate", " ", "mass", " ", "density", " ", "of", " ", "axion", " ", 
     "field", " ", 
     RowBox[{"(", 
      RowBox[{"eV", "^", "4"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rho0", "=", 
     RowBox[{"1.9", "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"mA", "/", 
         RowBox[{"10", "^", 
          RowBox[{"-", "23"}]}]}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"-", "2"}], ")"}]}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"rcPc", "/", 
         RowBox[{"10", "^", "3"}]}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"-", "4"}], ")"}]}], "*", "MSolar"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"rho0", "*=", 
     RowBox[{"kgToEv", "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"pcToM", "*", "mToEvMinus1"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"-", "3"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Scaling", " ", "constants"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aA", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"9.1", "*", 
        RowBox[{
         RowBox[{"10", "^", 
          RowBox[{"-", "2"}]}], "/", 
         RowBox[{"rcPc", "^", "2"}]}]}], ")"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"pcToM", "*", "mToEvMinus1"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"-", "2"}], ")"}]}]}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"Scaling", " ", "constant", " ", "of", " ", "axion", " ", 
     RowBox[{"(", 
      RowBox[{"eV", "^", "2"}], ")"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"aD", "=", "aA"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "Scaling", " ", "constant", " ", "of", " ", "dark", " ", "photon", " ", 
     RowBox[{"(", 
      RowBox[{"eV", "^", "2"}], ")"}]}], "*)"}], "\n", "\[IndentingNewLine]", 
   
   RowBox[{"(*", 
    RowBox[{"Core", " ", "radius", " ", 
     RowBox[{"(", 
      RowBox[{"eV", "^", 
       RowBox[{"-", "1"}]}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rc", "=", 
     RowBox[{"rcPc", "*", "pcToM", "*", "mToEvMinus1"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Calculate", " ", "amplitudes"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"phi0", "=", 
     RowBox[{
      RowBox[{"Sqrt", "[", 
       RowBox[{"2", "*", "rho0"}], "]"}], "/", "mA"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"Amplitude", " ", "of", " ", "axion", " ", "potential", " ", 
     RowBox[{"(", "eV", ")"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"XBar", "=", "phi0"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "Amplitude", " ", "of", " ", "dark", " ", "photon", " ", "potential", " ", 
     RowBox[{"(", "eV", ")"}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Coupling", " ", "constants", " ", "and", " ", "frequencies"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"gAc", "=", 
     RowBox[{
      RowBox[{"alpha", "/", "Pi"}], "/", "f"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"Coupling", " ", "constant", " ", 
     RowBox[{"(", 
      RowBox[{"eV", "^", 
       RowBox[{"-", "1"}]}], ")"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"epsilon", "=", 
     RowBox[{"1", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "3"}]}]}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Coupling", " ", "strength"}], ",", " ", 
     RowBox[{
      RowBox[{"1", "e"}], "-", 
      RowBox[{"3", " ", "to", " ", "1", "e"}], "-", "5"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"omegaA", "=", "mA"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"Oscillation", " ", "frequency", " ", "of", " ", "axion", " ", 
     RowBox[{"(", "eV", ")"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"omegaD", "=", 
     RowBox[{"mD", "-", "mU"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "Oscillation", " ", "frequency", " ", "of", " ", "dark", " ", "photon", 
     " ", 
     RowBox[{"(", "eV", ")"}]}], "*)"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQ7fRwOf8j/7eORY6MgiB6cek6JRB9PLLSDEzPv+MG
ohcFL/IE0XbfQ2JA9KU9t1JBtI/7oTwQnV1QUwiitzydVAailzX4VIHoVYy8
dSC67u9MMK3w3vTHUyDt9eMuwzMgXSy7NwxEfzNZkQSip4dsyAfRTzI3g+m/
LNMaQLRz6UIwXcbrPxlEq9VWTwPRy8JDXoJoNpFEMJ3UrvYTRJ+aegBMz2H5
HPwc5O6vOyJA9DLe4Ef/gbS+YegTEK24e4qlfsBbx4ILe8D0ScE5eSD68vl9
YPrukpgnP4H0oYREMP2X9dtbEP3g1F8wXXxSrZkx8K1j1MQ0MM10WuRuCJC+
ZOVzD0QDAD8EwJ4=
  "],
 CellLabel->"In[23]:=",ExpressionUUID->"ee4d7884-7e75-4be2-a5e1-bea50b2f1106"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Define", " ", "the", " ", "vector", " ", "field"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"fFunc", "[", 
      RowBox[{"x_", ",", " ", "y_", ",", " ", "z_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"a", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x", "^", "2"}], "+", 
             RowBox[{"y", "^", "2"}], "+", 
             RowBox[{"z", "^", "2"}]}], ")"}]}]}], ")"}], "^", "4"}]}], "*", 
      RowBox[{"Exp", "[", 
       RowBox[{"I", "*", "\[Omega]", "*", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x", "-", "x0"}], ")"}], "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"y", "-", "y0"}], ")"}], "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"z", "-", "z0"}], ")"}], "^", "2"}]}], "]"}]}], "]"}]}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<f: \>\"", ",", 
      RowBox[{"fFunc", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Bbar", "=", 
     RowBox[{"{", 
      RowBox[{"BbarX", ",", " ", "BbarY", ",", " ", "BbarZ"}], "}"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fvec", "[", 
      RowBox[{"x_", ",", " ", "y_", ",", " ", "z_"}], "]"}], ":=", 
     RowBox[{"Bbar", "*", 
      RowBox[{"fFunc", "[", 
       RowBox[{"x", ",", " ", "y", ",", " ", "z"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<fvec: \>\"", ",", " ", 
     RowBox[{"fvec", "[", 
      RowBox[{"x", ",", " ", "y", ",", " ", "z"}], "]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.934768134885001*^9, 3.934768141574718*^9}, {
  3.934768481871043*^9, 3.934768579933181*^9}, {3.9347687311883297`*^9, 
  3.934768754437994*^9}, {3.934768813599957*^9, 3.934768832263681*^9}, {
  3.934768902251248*^9, 3.934768925430141*^9}, {3.934769041222364*^9, 
  3.934769134550725*^9}, {3.934769230429555*^9, 3.934769318505973*^9}, {
  3.9347949693696404`*^9, 3.934794981851638*^9}, {3.934795051990401*^9, 
  3.93479509102967*^9}, {3.934853099277744*^9, 3.93485316609645*^9}, {
  3.9349479530970087`*^9, 3.934947953916671*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"0f455c98-76d4-4a85-8999-0dfab083c9a6"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"f: \"\>", "\[InvisibleSpace]", 
   FractionBox[
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x", "-", "x0"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"y", "-", "y0"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"z", "-", "z0"}], ")"}], "2"]}]], " ", "\[Omega]"}]], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"a", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}], "4"]]}],
  SequenceForm[
  "f: ", E^(
     Complex[0, 
       1] (($CellContext`x - $CellContext`x0)^2 + ($CellContext`y - \
$CellContext`y0)^2 + ($CellContext`z - $CellContext`z0)^2)^
      Rational[1, 2] $CellContext`\[Omega]) (
     1 + $CellContext`a ($CellContext`x^2 + $CellContext`y^2 + \
$CellContext`z^2))^(-4)],
  Editable->False]], "Print",
 CellChangeTimes->{3.935544893958304*^9},
 CellLabel->
  "\:8a08\:7b97\:4e2d\:ff1aIn[41]:=",ExpressionUUID->"6d7c3657-5328-47a9-91f0-\
c7b657409e64"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"fvec: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"BbarX", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x", "-", "x0"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"y", "-", "y0"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"z", "-", "z0"}], ")"}], "2"]}]], " ", "\[Omega]"}]]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"a", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}], "4"]], ",", 
     FractionBox[
      RowBox[{"BbarY", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x", "-", "x0"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"y", "-", "y0"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"z", "-", "z0"}], ")"}], "2"]}]], " ", "\[Omega]"}]]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"a", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}], "4"]], ",", 
     FractionBox[
      RowBox[{"BbarZ", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x", "-", "x0"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"y", "-", "y0"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"z", "-", "z0"}], ")"}], "2"]}]], " ", "\[Omega]"}]]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"a", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}], "4"]]}], "}"}]}],
  SequenceForm[
  "fvec: ", {$CellContext`BbarX 
    E^(Complex[
       0, 1] (($CellContext`x - $CellContext`x0)^2 + ($CellContext`y - \
$CellContext`y0)^2 + ($CellContext`z - $CellContext`z0)^2)^
       Rational[1, 2] $CellContext`\[Omega]) (
      1 + $CellContext`a ($CellContext`x^2 + $CellContext`y^2 + \
$CellContext`z^2))^(-4), $CellContext`BbarY 
    E^(Complex[
       0, 1] (($CellContext`x - $CellContext`x0)^2 + ($CellContext`y - \
$CellContext`y0)^2 + ($CellContext`z - $CellContext`z0)^2)^
       Rational[1, 2] $CellContext`\[Omega]) (
      1 + $CellContext`a ($CellContext`x^2 + $CellContext`y^2 + \
$CellContext`z^2))^(-4), $CellContext`BbarZ 
    E^(Complex[
       0, 1] (($CellContext`x - $CellContext`x0)^2 + ($CellContext`y - \
$CellContext`y0)^2 + ($CellContext`z - $CellContext`z0)^2)^
       Rational[1, 2] $CellContext`\[Omega]) (
      1 + $CellContext`a ($CellContext`x^2 + $CellContext`y^2 + \
$CellContext`z^2))^(-4)}],
  Editable->False]], "Print",
 CellChangeTimes->{3.935544893960195*^9},
 CellLabel->
  "\:8a08\:7b97\:4e2d\:ff1aIn[41]:=",ExpressionUUID->"4325ebda-490a-458f-bcbb-\
dd3cc2812664"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440, 770},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"14.0 \:95dc\:65bc  Mac OS X ARM (64-bit) \
(2023\:5e7412\:670812\:65e5)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"6350c368-7816-4c53-92cc-82e35d9b1127"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 886, 18, 73, "Input",ExpressionUUID->"fed76a7f-45c0-4e6e-b223-ec764040dce8"],
Cell[1469, 42, 2786, 44, 28, "Message",ExpressionUUID->"4b6ec72f-82d1-406f-9127-c670bccc4d34"]
}, Open  ]],
Cell[4270, 89, 4393, 97, 467, "Input",ExpressionUUID->"1b0b008a-0a48-400e-b450-156719303b6a"],
Cell[8666, 188, 1695, 46, 263, "Input",ExpressionUUID->"55491fca-3546-4eb2-b44c-98b0beddd20e"],
Cell[10364, 236, 7009, 205, 691, "Input",ExpressionUUID->"ee4d7884-7e75-4be2-a5e1-bea50b2f1106"],
Cell[CellGroupData[{
Cell[17398, 445, 2551, 67, 179, "Input",ExpressionUUID->"0f455c98-76d4-4a85-8999-0dfab083c9a6"],
Cell[CellGroupData[{
Cell[19974, 516, 1298, 38, 53, "Print",ExpressionUUID->"6d7c3657-5328-47a9-91f0-c7b657409e64"],
Cell[21275, 556, 3707, 101, 53, "Print",ExpressionUUID->"4325ebda-490a-458f-bcbb-dd3cc2812664"]
}, Open  ]]
}, Open  ]]
}
]
*)

